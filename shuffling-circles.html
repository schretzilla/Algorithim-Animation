<!doctype html>
<html>

<head>
		<title>D3 Test</title>
		<script src="d3.v4.js"></script>
</head>

<body>
  <script>
    //global vars
    let startYCord = 100;
    let startXCord = 50;
    let startRadius = 25;
    let moveDuration = 1500;
    //build canvas
    var canvas = d3.select("body")
            .append("svg")
            .attr("width", 500)
            .attr("height", 500);

    //drawl 2 circles
    let Homecircle1 = canvas.append("circle")
                        .attr("cx", startXCord)
                        .attr("cy", startYCord)
                        .attr("r", startRadius)
                        .attr("fill", "blue");
    
    let Homecircle2 = canvas.append("circle")
                        .attr("cx", startXCord+ (2*startRadius))
                        .attr("cy", startYCord)
                        .attr("r", startRadius)
                        .attr("fill", "orange");

    let animationTimeDuration = swapPlaces(Homecircle1, Homecircle2, 0);
    //TODO add timeout here instead of passing it as a var
    swapPlaces(Homecircle1, Homecircle2, animationTimeDuration);

  
    //animationStartTime = the time in which previous animations have ended 
    function swapPlaces(circle1, circle2, animationStartTime){
      console.log("swap called");
      // The displaced y position where cirlce1's swaps will occure
      let stagingYCord1 = 150;
      // The displaced y position where circle2's swaps will occure
      let stagingYCord2 = 150 + (2*startRadius);

      //Move one circle up one full circle radius
      circle1.transition()
          .delay(animationStartTime)
          .duration(moveDuration)   //measured in Mili Seconds
          .attr("cy", stagingYCord1);

      //Move the other circle up 2 full radius
      circle2.transition()
          .delay(animationStartTime)
          .duration(moveDuration)
          .attr("cy", stagingYCord2);
      
      //Swap circles' x positions
      circle1.transition()
        .delay(animationStartTime + moveDuration)
        .duration(moveDuration)
        .attr("cx", circle2.attr("cx"));

      circle2.transition()
        .delay(animationStartTime + moveDuration)
        .duration(moveDuration)
        .attr("cx", circle1.attr("cx"));

      //Move back to original line
      circle1.transition()
        .delay(animationStartTime + 2*moveDuration)
        .duration(moveDuration)
        .attr("cy", startYCord);

      circle2.transition()
        .delay(animationStartTime + 2*moveDuration)
        .duration(moveDuration)
        .attr("cy", startYCord);

      return 3*moveDuration;
    }

  </script>

</body>

</html>